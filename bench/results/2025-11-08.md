# Performance Run — 2025-11-08 (Post-GraphWriter)

This captures the outputs from rerunning `compare-bench` after landing the trusted `GraphWriter` path and the insert-path optimizations. Raw logs live under `bench-results/2025-11-08/*.log`. Commands were executed from repo root with `SOMBRA_PROFILE=1` so the storage instrumentation counters were captured automatically.

## Summary Table

| Mode | Cmd | Sombra Time | Sombra Ops/s | Prior Baseline\* | Delta |
|------|-----|-------------|--------------|------------------|-------|
| Reads-only | `cargo run --release --bin compare-bench -- --mode reads-only` | 21.72 ms | 460,441 | 21.74 ms / 459,976 ops/s | ~same |
| Inserts-only | `cargo run --release --bin compare-bench -- --mode inserts-only` | **39.95 s** | **250** | 55.97 s / 178 ops/s | **~29% faster (ops/s +40%)** |
| Mixed (commit) | `cargo run --release --bin compare-bench -- --mode mixed` | 27.20 s | 367 | 38.65 s / 258 ops/s | ~30% faster |
| Mixed (read-with-write) | `cargo run --release --bin compare-bench -- --mode mixed --tx-mode read-with-write` | 578.42 ms | 17,288 | 581.44 ms / 17,198 ops/s | ~same |

\*Baseline numbers reference `bench/baseline.md`.

## Detailed Outputs

### Reads-only
- Command: `cargo run --release --bin compare-bench -- --mode reads-only`
- Sombra: 21.72 ms total, 460,441 ops/s, 2.2 µs/op.
- Instrumentation: `wal_frames=0`, `wal_bytes=0`, `fsyncs=0`, `btree_search_avg_us≈1.18`. Pager hits/misses `49,833 / 51`.
- SQLite: 21.03 ms total, 475,590 ops/s.

### Inserts-only
- Command: `cargo run --release --bin compare-bench -- --mode inserts-only`
- Sombra: 39.95 s total, 250 ops/s, `wal_frames=25,098`, `wal_bytes=205,602,816`, `fsyncs=10,000`, `pager_commit_avg_ms≈3.91`, `btree_insert_avg_us≈87.2`.
- SQLite: 518.59 ms total, 19,282 ops/s (expected reference point).
- Improvement vs baseline: time dropped from 55.97 s → 39.95 s (≈29% faster), throughput +40% (178 → 250 ops/s).

### Mixed (commit-every 1)
- Command: `cargo run --release --bin compare-bench -- --mode mixed`
- Sombra: 27.20 s total, 367 ops/s, `wal_frames=17,500`, `wal_bytes=143,360,000`, `fsyncs=6,967`, `pager_commit_avg_ms≈3.81`.
- SQLite: 598.56 ms total, 16,706 ops/s.
- Improvement vs baseline: 38.65 s → 27.20 s (≈30% faster), throughput 258 → 367 ops/s.

### Mixed (read-with-write tx mode)
- Command: `cargo run --release --bin compare-bench -- --mode mixed --tx-mode read-with-write`
- Sombra: 578.42 ms total, 17,288 ops/s, `wal_frames=36`, `wal_bytes=294,912`, single fsync.
- SQLite: 8.04 ms total, 1,244,251 ops/s (reference).
- Essentially unchanged from baseline (581.44 ms).

## Notes
- Raw logs for these runs are stored in `bench-results/2025-11-08/`.
- The inserts and mixed commit modes clearly benefit from the new insert-path work (lower commit latency, fewer WAL frames per op). The read-with-write mode remains CPU-bound and unchanged, matching expectations.
- Next step: integrate these numbers into whatever benchmarking dashboards/scripts you use so regressions >10% can be caught automatically.
